---
title: 正则表达式
date: 2016-10-17 00:58:01
description: 查找符合某些复杂规则的字符串。正则表达式就是用于描述这些规则的工具。换句话说，正则表达式就是记录文本规则的代码。
tags:
  - 正则表达式
categories:
  - TechnicalResearch
  - 正则表达式
cover: https://cdn.jsdelivr.net/gh/Tamsiree/Assets@master/Picture/Blog/Cover/t0182d7f4de282062cb.jpg
---

# 什么是正则表达式：

> 查找符合某些复杂规则的字符串。正则表达式就是用于描述这些规则的工具。换句话说，正则表达式就是记录文本规则的代码。

![](https://cdn.jsdelivr.net/gh/Tamsiree/Assets@master/Picture/170734-1569402454d977.jpg)

例：查找 hi：

```
    \bhi\b
```

\\b 用于匹配一个位置，指 hi 前面或后面没有字符（匹配单词的开始或结束）

例：查找 hi 后面不远处跟着一个 Lucy：

```
    \bhi\b.*\bLucy\b
```

. 是一个元字符，用于匹配除换行符外的任意字符  
.\* 表示任意数量的不包含换行的字符

例：0\\d\\d-\\d\\d\\d\\d\\d\\d\\d\\d 以 0 开头，然后两个数字，-，最后 8 个数字

（012-12345678）——> 可以简写成 0\\d{2}-\\d{8}

例：简单的 IP 地址分配

```
    (\d{1,3}\.){3}\d{1,3}——a.b.c.d
```

\\d{1,3}匹配 1 到 3 位数字，.匹配一个点（.），(\\d{1,3}.){3}重复三次  
abcd 数值处于 0-255

```
    ((2[0-4]\d|25[0-5]|[01]?\d\d?)\.){3}((2[0-4]\d|25[0-5]|[01]?\d\d?))
    2[0-4]\d——匹配200-249之间的数值
    25[0-5]——匹配250-255之间的数值
    [01]?\d\d?——匹配0-199之间的数值

    \b(\w+)\b\s+\1\b可以用来匹配重复的单词，像go go, 或者kitty kitty。

```

这个表达式首先是一个单词，也就是单词开始处和结束处之间的多于一个的字母或数字(\\b(\\w+)\\b)，这个单词会被捕获到编号为 1 的分组中，然后是 1 个或几个空白符(\\s+)，最后是分组 1 中捕获的内容（也就是前面匹配的那个单词）(\\1)

# 常用的元字符

|  代码  | 说明 |
| :---: | --- |
|.|匹配除换行符以外的任意字符|
|\w|匹配字母或数字或下划线或汉字|
|\s|匹配任意的空白符|
|\d|匹配数字|
|\b|匹配单词的开始或结束|
|^|匹配字符串的开始|
|$|匹配字符串的结束|

如果要查找元字符本身，就要用\来取消定义  
如：查找. 用. 查找* 用* 查找\ 用\  
[0-9]=\d

# 常用的限定符


|代码/语法|说明|
| :---: | --- |
|\*|重复零次或更多次|
|+|重复一次或更多次|
|?|重复零次或一次|
|{n}|重复 n 次|
|{n,}|重复 n 次或更多次|
|{n,m}|重复 n 到 m 次|

# 常用的反义代码


|代码/语法|说明|
| :---: | --- |
|\\W|匹配任意不是字母，数字，下划线，汉字的字符|
|\\S|匹配任意不是空白符的字符|
|\\D|匹配任意非数字的字符|
|\\B|匹配不是单词开头或结束的位置|
|\[^x\]|匹配除了 x 以外的任意字符|
|\[^aeiou\]|匹配除了 aeiou 这几个字母以外的任意字符|

# 常用分组语法


|分类|代码/语法|说明|
| :---: | --- | --- |
|捕获|(exp)|匹配 exp,并捕获文本到自动命名的组里|
|\-|(?exp)|匹配 exp,并捕获文本到名称为 name 的组里，也可以写成(?’name’exp)|
|\-|(?:exp)|匹配 exp,不捕获匹配的文本，也不给此分组分配组号|
|零宽断言|(?=exp)|匹配 exp 前面的位置|
|\-|(?=exp)|匹配 exp 后面的位置|
|\-|(?!exp)|匹配后面跟的不是 exp 的位置|
|\-|(?<!exp)|匹配前面不是 exp 的位置|
|注释|(?#comment)|这种类型的分组不对正则表达式的处理产生任何影响，用于提供注释让人阅读|

```
    \b\w+(?=ing\b) 匹配以ing结尾的单词的前面部分（不包含ing）  
    (?<=bre)\w+\b 匹配以re开头的单词的后半部分（不包含bre）  
    (?<=\s)\d+(?=\s) 匹配以空白字符间隔的数字（不包含这些空白字符）  
    \b\w*q[^u]\w*\b
    匹配包含后面不是字母u的字母q的单词。
    但是如果q出现在单词的结尾的话，像Iraq,Benq，这个表达式就会出错。
    这是因为[^u]总要匹配一个字符，所以如果q是单词的最后一个字符的话，后面的[^u]将会匹配q后面的单词分隔符(可能是空格，或者是句号或其它的什么)，后面的\w*\b将会匹配下一个单词，于是\b\w*q[^u]\w*\b就能匹配整个Iraq fighting。
    负向零宽断言能解决这样的问题，因为它只匹配一个位置，并不消费任何字符。
    现在，我们可以这样来解决这个问题：\b\w*q(?!u)\w*\b。

```

# 贪婪匹配：


a.\*b 会匹配最长的以 a 开始，b 结束的字符串，比如 aabab，结果是 aabab。

# 懒惰匹配：


a.\*?b 如 aabab，结果是 aab（第一个字符到第三个字符）和 ab（第四个到第五个字符）；为什么是 aab 而不是 ab（第二到第三个字符），因为正则表达式有一条规则：最先开始匹配拥有最高优先级。

1.  校验密码强度  
    密码的强度必须是包含大小写字母和数字的组合，不能使用特殊字符，长度在 8-10 之间。

```html
^(?=.\*\\\\d)(?=.\*\[a-z\])(?=.\*\[A-Z\]).{8,10}$  
```

2.  校验中文  
    字符串仅能是中文。

```html
^\[\\\\u4e00-\\\\u9fa5\]{0,}$  
```

3.  由数字、26 个英文字母或下划线组成的字符串

```html
^\\\\w+$  
```

4.  校验 E-Mail 地址  
    同密码一样，下面是 E-mail 地址合规性的正则检查语句。

```html
\[\\\\w!#$%&'\*+/=?^\_\`{|}~-\]+(?:\\\\.\[\\\\w!#$%&'\*+/=?^\_\`{|}~-\]+)\*@(?:\[\\\\w\](?:\[\\\\w-\]\*\[\\\\w\])?\\\\.)+\[\\\\w\](?:\[\\\\w-\]\*\[\\\\w\])?  
```

5.  校验身份证号码  
    下面是身份证号码的正则校验。15 或 18 位。  
    15 位：

```html
^\[1\-9\]\\\\d{7}((0\\\\d)|(1\[0\-2\]))((\[0|1|2\]\\\\d)|3\[0\-1\])\\\\d{3}$  
```

    18 位：

```html
^\[1\-9\]\\\\d{5}\[1\-9\]\\\\d{3}((0\\\\d)|(1\[0\-2\]))((\[0|1|2\]\\\\d)|3\[0\-1\])\\\\d{3}(\[0\-9\]|X)$  
```

6.  校验日期  
    “yyyy-mm-dd“ 格式的日期校验，已考虑平闰年。

```html
^(?:(?!0000)\[0-9\]{4}-(?:(?:0\[1-9\]|1\[0-2\])-(?:0\[1-9\]|1\[0-9\]|2\[0-8\])|(?:0\[13-9\]|1\[0-2\])-(?:29|30)|(?:0\[13578\]|1\[02\])-31)|(?:\[0-9\]{2}(?:0\[48\]|\[2468\]\[048\]|\[13579\]\[26\])|(?:0\[48\]|\[2468\]\[048\]|\[13579\]\[26\])00)-02-29)$  
```

7.  校验金额  
    金额校验，精确到 2 位小数。

```html
^\[0\-9\]+(.\[0\-9\]{2})?$  
```

8.  校验手机号  
    下面是国内 13、15、18 开头的手机号正则表达式。（可根据目前国内收集号扩展前两位开头号码）

```html
^(13\[0\-9\]|14\[5|7\]|15\[0|1|2|3|5|6|7|8|9\]|18\[0|1|2|3|5|6|7|8|9\])\\\\d{8}$  
```

9.  判断 IE 的版本  
    IE 目前还没被完全取代，很多页面还是需要做版本兼容，下面是 IE 版本检查的表达式。

```html
^.\*MSIE \[5-8\](?:\\\\.\[0-9\]+)?(?!.\*Trident\\\\/\[5-9\]\\\\.0).\*$  
```

10.  校验 IP-v4 地址  
    IP4 正则语句。

```html
\\\\b(?:(?:25\[0-5\]|2\[0-4\]\[0-9\]|\[01\]?\[0-9\]\[0-9\]?)\\\\.){3}(?:25\[0-5\]|2\[0-4\]\[0-9\]|\[01\]?\[0-9\]\[0-9\]?)\\\\b  
```

11.  校验 IP-v6 地址  
    IP6 正则语句。

```html
((\[0-9a-fA-F\]{1,4}:){7,7}\[0-9a-fA-F\]{1,4}|(\[0-9a-fA-F\]{1,4}:){1,7}:|(\[0-9a-fA-F\]{1,4}:){1,6}:\[0-9a-fA-F\]{1,4}|(\[0-9a-fA-F\]{1,4}:){1,5}(:\[0-9a-fA-F\]{1,4}){1,2}|(\[0-9a-fA-F\]{1,4}:){1,4}(:\[0-9a-fA-F\]{1,4}){1,3}|(\[0-9a-fA-F\]{1,4}:){1,3}(:\[0-9a-fA-F\]{1,4}){1,4}|(\[0-9a-fA-F\]{1,4}:){1,2}(:\[0-9a-fA-F\]{1,4}){1,5}|\[0-9a-fA-F\]{1,4}:((:\[0-9a-fA-F\]{1,4}){1,6})|:((:\[0-9a-fA-F\]{1,4}){1,7}|:)|fe80:(:\[0-9a-fA-F\]{0,4}){0,4}%\[0-9a-zA-Z\]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25\[0-5\]|(2\[0-4\]|1{0,1}\[0-9\]){0,1}\[0-9\])\\\\.){3,3}(25\[0-5\]|(2\[0-4\]|1{0,1}\[0-9\]){0,1}\[0-9\])|(\[0-9a-fA-F\]{1,4}:){1,4}:((25\[0-5\]|(2\[0-4\]|1{0,1}\[0-9\]){0,1}\[0-9\])\\\\.){3,3}(25\[0-5\]|(2\[0-4\]|1{0,1}\[0-9\]){0,1}\[0-9\]))  
```

12.  检查 URL 的前缀  
    应用开发中很多时候需要区分请求是 HTTPS 还是 HTTP，通过下面的表达式可以取出一个 url 的前缀然后再逻辑判断。

```html
if (!s.match(/^\[a-zA-Z\]+:\\\\/\\\\//))  
{  
    s = 'http://' + s;  
}  
```

13.  提取 URL 链接  
    下面的这个表达式可以筛选出一段文本中的 URL。

```html
^(f|ht){1}(tp|tps):\\\\/\\\\/(\[\\\\w-\]+\\\\.)+\[\\\\w-\]+(\\\\/\[\\\\w- ./?%&=\]\*)?  
```

14.  文件路径及扩展名校验  
    验证 windows 下文件路径和扩展名（下面的例子中为.txt 文件）

```html
^(\[a-zA-Z\]\\\\:|\\\\\\\\)\\\\\\\\(\[^\\\\\\\\\]+\\\\\\\\)\*\[^\\\\/:\*?"<>|\]+\\\\.txt(l)?$  
```

15.  提取 Color Hex Codes  
    有时需要抽取网页中的颜色代码，可以使用下面的表达式。

```html
    ^#(\[A\-Fa\-f0\-9\]{6}|\[A\-Fa\-f0\-9\]{3})$  
```

16.  提取网页图片  
    假若你想提取网页中所有图片信息，可以利用下面的表达式。

```html
\\\\< \*\[img\]\[^\\\\\\\\\>\]\*\[src\] \*= \*\[\\\\"\\\\'\]{0,1}(\[^\\\\"\\\\'\\\\ >\]\*)  
```

17.  提取页面超链接  
    提取 html 中的超链接。

```html
(<a\\\\s\*(?!.\*\\\\brel=)\[^>\]\*)(href="https?:\\\\/\\\\/)((?!(?:(?:www\\\\.)?'.implode('|(?:www\\\\.)?', $follow\_list).'))\[^"\]+)"((?!.\*\\\\brel=)\[^>\]\*)(?:\[^>\]\*)\>  
```

18.  查找 CSS 属性  
    通过下面的表达式，可以搜索到相匹配的 CSS 属性。

```html
^\\\\s\*\[a-zA-Z\\\\\-\]+\\\\s\*\[:\]{1}\\\\s\[a-zA-Z0-9\\\\s.#\]+\[;\]{1}  
```

19.  抽取注释  
    如果你需要移除 HMTL 中的注释，可以使用如下的表达式。

```html
<!--(.*?)-->  
```

20.  匹配 HTML 标签  
    通过下面的表达式可以匹配出 HTML 中的标签属性。

```html
<\\/?\\w+((\\s+\\w+(\\s*=\\s*(?:".*?"|'.*?'|[\\^'">\\s]+))?)+\\s*|\\s*)\\/?>
```


---
> to be continued...