<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>C# 代码优化堆内存 | Tamsiree</title><meta name="author" content="Tamsiree,tamsiree.com@gmail.com"><meta name="copyright" content="Tamsiree"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="C#是在虚拟机（VM）环境当中运行的（Mono虚拟机或IL2CPP虚拟机），其分配的堆内存是由虚拟机进行管理与回收的，因此，C#代码被称为“托管代码”，其堆内存又被称为“托管内存”。">
<meta property="og:type" content="article">
<meta property="og:title" content="C# 代码优化堆内存">
<meta property="og:url" content="https://tamsiree.com/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C/CSharp%E4%BB%A3%E7%A0%81%E4%BC%98%E5%8C%96%E5%A0%86%E5%86%85%E5%AD%98/index.html">
<meta property="og:site_name" content="Tamsiree">
<meta property="og:description" content="C#是在虚拟机（VM）环境当中运行的（Mono虚拟机或IL2CPP虚拟机），其分配的堆内存是由虚拟机进行管理与回收的，因此，C#代码被称为“托管代码”，其堆内存又被称为“托管内存”。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/Tamsiree/Assets@master/Picture/Blog/Cover/1-1-1024x576.jpg">
<meta property="article:published_time" content="2021-05-13T02:30:39.000Z">
<meta property="article:modified_time" content="2025-11-05T13:53:39.345Z">
<meta property="article:author" content="Tamsiree">
<meta property="article:tag" content="C#">
<meta property="article:tag" content="编程语言">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/Tamsiree/Assets@master/Picture/Blog/Cover/1-1-1024x576.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "C# 代码优化堆内存",
  "url": "https://tamsiree.com/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C/CSharp%E4%BB%A3%E7%A0%81%E4%BC%98%E5%8C%96%E5%A0%86%E5%86%85%E5%AD%98/",
  "image": "https://cdn.jsdelivr.net/gh/Tamsiree/Assets@master/Picture/Blog/Cover/1-1-1024x576.jpg",
  "datePublished": "2021-05-13T02:30:39.000Z",
  "dateModified": "2025-11-05T13:53:39.345Z",
  "author": [
    {
      "@type": "Person",
      "name": "Tamsiree",
      "url": "https://tamsiree.com"
    }
  ]
}</script><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/Tamsiree/Assets@master/Avatar/avatar_sky_circle.png"><link rel="canonical" href="https://tamsiree.com/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C/CSharp%E4%BB%A3%E7%A0%81%E4%BC%98%E5%8C%96%E5%A0%86%E5%86%85%E5%AD%98/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="manifest" href="/manifest.json"/><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"/><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"/><link rel="stylesheet" href="/css/index.css?v=5.5.3"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1.7/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const mediaQueryDark = window.matchMedia('(prefers-color-scheme: dark)')
          const mediaQueryLight = window.matchMedia('(prefers-color-scheme: light)')

          if (theme === undefined) {
            if (mediaQueryLight.matches) activateLightMode()
            else if (mediaQueryDark.matches) activateDarkMode()
            else {
              const hour = new Date().getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            mediaQueryDark.addEventListener('change', () => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else {
            theme === 'light' ? activateLightMode() : activateDarkMode()
          }
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: 'ca-pub-8688374801147098',
  enable_page_level_ads: 'true'
});</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"pagination":{"enable":false,"hitsPerPage":8},"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Tamsiree","link":"链接: ","source":"来源: Tamsiree","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: true,
  islazyloadPlugin: true,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'C# 代码优化堆内存',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"><script>if (window.location.protocol !== 'https:' && window.location.hostname !== 'localhost' && window.location.hostname !== '127.0.0.1') { window.location.href = window.location.href.replace('http:', 'https:'); }</script><meta name="generator" content="Hexo 8.1.1"><link rel="alternate" href="/atom.xml" title="Tamsiree" type="application/atom+xml">
</head><body><div class="bg-animation" id="web_bg" style="background-color: #f0f0f0;"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/images/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/Tamsiree/Assets@master/Avatar/avatar_sky_circle.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">200</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">140</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">143</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-keyboard"></i><span> 目录</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-torah"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-leaf"></i><span> 风向标</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-dragon"></i><span> 寻龙尺</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-icons"></i><span> 回味</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 画廊</span></a></li><li><a class="site-page child" href="/book/"><i class="fa-fw fas fa-book"></i><span> 书屋</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 神秘链接</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fas fa-clipboard-list"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-id-badge"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/night_sky/"><i class="fa-fw fas fa-magic"></i><span> 冥想空间</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://cdn.jsdelivr.net/gh/Tamsiree/Assets@master/Picture/Blog/Cover/1-1-1024x576.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Tamsiree</span></a><a class="nav-page-title" href="/"><span class="site-name">C# 代码优化堆内存</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-keyboard"></i><span> 目录</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-torah"></i><span> 时间轴</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-leaf"></i><span> 风向标</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-dragon"></i><span> 寻龙尺</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-icons"></i><span> 回味</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 画廊</span></a></li><li><a class="site-page child" href="/book/"><i class="fa-fw fas fa-book"></i><span> 书屋</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 神秘链接</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fas fa-clipboard-list"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-id-badge"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page" href="/night_sky/"><i class="fa-fw fas fa-magic"></i><span> 冥想空间</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">C# 代码优化堆内存</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-05-13T02:30:39.000Z" title="发表于 2021-05-13 10:30:39">2021-05-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-11-05T13:53:39.345Z" title="更新于 2025-11-05 21:53:39">2025-11-05</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/">编程语言</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C/">C#</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">2.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>6分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>在上期 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.uwa4d.com/archives/UWA_Pipeline35.html">《C# 代码优化：拯救你的 CPU 耗时》</a> 中，我们依托 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.uwa4d.com/archives/pipelinesummary.html">UWA 本地资源检测</a>，从“时间” 的角度对 C# 代码检测中和 CPU 耗时相关的知识点为大家进行了简单的讲解。本篇将从 “空间” 角度入手，为大家继续梳理 C# 代码检测的相关规则。</p>
<p>C# 是在虚拟机（VM）环境当中运行的（Mono 虚拟机或 IL2CPP 虚拟机），其分配的堆内存是由虚拟机进行管理与回收的，因此，C# 代码被称为“托管代码”，其堆内存又被称为“托管内存”。托管内存的释放依赖于虚拟机的 GC（垃圾回收）机制，本文就不展开讨论了。</p>
<p>C# 程序开发要遵循的一个基本原则就是避免不必要的堆内存分配，而堆内存分配主要会造成以下后果：</p>
<ul>
<li>  程序所占用的内存总量过大。内存是有限的资源，对于游戏（特别是移动游戏）来说，内存的占用可谓是寸土寸金。过多的无法释放的内存很可能导致程序崩溃的现象。</li>
<li>  过多的分配次数会导致堆碎片变多，从而可能导致无法开辟出所需要的连续的内存，这也会导致程序崩溃。</li>
<li>  内存分配会触发 GC（垃圾回收），而 GC 的代价较高，会造成卡顿。</li>
</ul>
<h3 id="1、该类的方法中存在-tag-的调用"><a href="#1、该类的方法中存在-tag-的调用" class="headerlink" title="1、该类的方法中存在 .tag 的调用"></a>1、该类的方法中存在 .tag 的调用</h3><p><img src="/images/loading.gif" data-lazy-src="https://img-blog.csdnimg.cn/img_convert/24a16a95dd26a0eb81ff1b0b59728649.png"></p>
<p>tag 是场景中 GameObject 的标签，而类 GameObject 的成员 tag 是一个属性，在获取该属性时，实质上是调用 get_tag()函数，从 native 层返回一个字符串。字符串属于引用类型，这个字符串的返回，会造成堆内存的分配。然而，Unity 引擎也没有通过缓存的方式对 get_tag 进行优化，在每次调用 get_tag 时，都会重新分配堆内存。</p>
<p>所以当需要对 tag 进行比较时，我们建议使用函数 GameObject.CompareTag()，该函数是在 native 层实现的，不会造成托管堆内存的分配，也就避免了 GC 压力。</p>
<hr>
<h3 id="2、该类的方法中存在对纹理-GetPixels-GetPixels32-调用"><a href="#2、该类的方法中存在对纹理-GetPixels-GetPixels32-调用" class="headerlink" title="2、该类的方法中存在对纹理 GetPixels()/GetPixels32()调用"></a>2、该类的方法中存在对纹理 GetPixels()/GetPixels32()调用</h3><p><img src="/images/loading.gif" data-lazy-src="https://img-blog.csdnimg.cn/img_convert/83ae5131eea8c76c3a0c1eedb484c42d.png"></p>
<p>对 Texture2D 类型的对象调用 GetPixels()和 GetPixels32()，一般都是为了获取指定 Mipmap 层的全部像素信息，而图片上的像素数量往往是很庞大的。</p>
<p>** 从内存分配上讲 **，该函数会在托管堆中分配内存，用以存储纹理数据的像素信息，但引擎不会对其进行缓存。所以如果在频繁调用的函数中使用，就会造成持续性的堆内存分配。</p>
<p>** 从耗时上讲 **，擅长执行大规模并行运算的 GPU 来处理图片信息是非常容易的，但 CPU 在进行逐个像素信息的获取时，就显得有些吃力了。并且 GetPixels()在实现上是由 CPU 同步执行的，所以耗时会较高，同时会阻塞调用的线程，从而可能会造成卡顿。因此在非必要的情况下，并不建议使用 GetPixels()。</p>
<hr>
<h3 id="3、该类的方法中存在-GetComponentsInChildren-调用-该类的方法中存在-GetComponentsInParent-调用"><a href="#3、该类的方法中存在-GetComponentsInChildren-调用-该类的方法中存在-GetComponentsInParent-调用" class="headerlink" title="3、该类的方法中存在 GetComponentsInChildren 调用 / 该类的方法中存在 GetComponentsInParent 调用"></a>3、该类的方法中存在 GetComponentsInChildren 调用 / 该类的方法中存在 GetComponentsInParent 调用</h3><p><img src="/images/loading.gif" data-lazy-src="https://img-blog.csdnimg.cn/img_convert/56e903a2ce66093f56b1c11bbee919e2.png"></p>
<p>在之前的文章 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.uwa4d.com/archives/UWA_Pipeline35.html">《C# 代码优化：拯救你的 CPU 耗时》</a> 中，我们对 GetComponentsInChildren 和 GetComponentsInParent 进行了简单地讲解。在这里，我们进一步补充说明，这两者在实际调用中，因为涉及到对象的遍历和结果的返回，所以如果使用不当，就会造成持续性的堆内存分配。我们建议开发团队使用接受 List 类型的引用作为参数的版本，这样就可以避免每次调用都造成堆内存的分配。</p>
<hr>
<h3 id="4、该类的方法中存在-Linq-相关函数的调用"><a href="#4、该类的方法中存在-Linq-相关函数的调用" class="headerlink" title="4、该类的方法中存在 Linq 相关函数的调用"></a>4、该类的方法中存在 Linq 相关函数的调用</h3><p><img src="/images/loading.gif" data-lazy-src="https://img-blog.csdnimg.cn/img_convert/d246bdc025b57153a02bf6a973a25643.png"></p>
<p>Linq 相关的函数一般都用于对数据的查询和处理。功能上简单来讲，就是对一堆数据进行各种 if 判断和 for 循环处理。使用 Linq 提供的 API，我们可以写出 SQL 语句风格的代码来进行集合数据的处理，这能够明显提升我们代码的简明性、可读性，维护上也更方便，从而提升编写效率，但是这些优点是以性能的开销为代价的。</p>
<p>Linq 在执行过程中会产生一些临时变量，而且会用到委托（lambda 表达式）。如果使用委托作为条件的判定方法，时间开销就会很高，并且会造成一定的堆内存分配。所以在一般的 Unity 游戏项目开发中，我们不推荐使用 Linq 相关的函数。在编辑器功能开发中，我们才常常把 Linq 和 Reflection 进行配合使用。</p>
<hr>
<h3 id="5、该类的方法中存在对-Renderer-进行-sharedMaterials-的获取"><a href="#5、该类的方法中存在对-Renderer-进行-sharedMaterials-的获取" class="headerlink" title="5、该类的方法中存在对 Renderer 进行 sharedMaterials 的获取"></a>5、该类的方法中存在对 Renderer 进行 sharedMaterials 的获取</h3><p><img src="/images/loading.gif" data-lazy-src="https://img-blog.csdnimg.cn/img_convert/22891fd79e1919e03d05f8e19fc9d077.png"></p>
<p>同样，在之前的文章 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.uwa4d.com/archives/UWA_Pipeline35.html">《C# 代码优化：拯救你的 CPU 耗时》</a> 中，我们对. material/materials 进行了讲解。简单地说，对. material(s)的调用会产生新的材质球实例；而 sharedMaterials 则是共享材质，不会生成新的材质实例。然而，对. sharedMaterials 的调用，依旧会分配堆内存——每次调用都会分配一个用以存放 Material 的索引的数组。虽然该数组占用的内存相对较小，但我们还是建议不要对其进行频繁地调用。</p>
<hr>
<h3 id="6、该类的方法中存在-Input-touches-调用"><a href="#6、该类的方法中存在-Input-touches-调用" class="headerlink" title="6、该类的方法中存在 Input.touches 调用"></a>6、该类的方法中存在 Input.touches 调用</h3><p><img src="/images/loading.gif" data-lazy-src="https://img-blog.csdnimg.cn/img_convert/4f2adc17d0a313fbc32eba8dab833609.png"></p>
<p>移动端项目交互里，点触操作可以说是极为频繁与常见。在点触操作的获取上，Input.touches 就是用来获取当前帧中所有点触操作的状态和相应数据。但是查看. touches 的实现，我们就会发现：每次在对其调用时，都会 new 一个数组 touches，从而造成一定的堆内存分配。所以开发团队要避免 Input.touches 的频繁使用以防造成堆内存的额外占用。</p>
<hr>
<h3 id="7、FindObjectsOfType-调用"><a href="#7、FindObjectsOfType-调用" class="headerlink" title="7、FindObjectsOfType 调用"></a>7、FindObjectsOfType 调用</h3><p>在之前的文章 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.uwa4d.com/archives/UWA_Pipeline35.html">《C# 代码优化：拯救你的 CPU 耗时》</a> 中，我们对 FindObjectsOfType 进行了简单地介绍。它在增大 CPU 耗时的同时，也会占用相当一部分的堆内存分配，所以建议通过一次调用，缓存结果的方式减少其带来的性能影响。</p>
<hr>
<h3 id="8、该类的方法中存在-TextAsset-WWW-bytes-调用"><a href="#8、该类的方法中存在-TextAsset-WWW-bytes-调用" class="headerlink" title="8、该类的方法中存在 TextAsset/WWW.bytes 调用"></a>8、该类的方法中存在 TextAsset/WWW.bytes 调用</h3><p><img src="/images/loading.gif" data-lazy-src="https://img-blog.csdnimg.cn/img_convert/d2a2591abb957ff4748364856a7065eb.png"></p>
<p>该规则针对的其实是两条不相关的 Unity API。首先是 TextAsset 的 bytes 属性。TextAsset 是 Unity 中的一种文本资源，它支持包括 txt、html、bytes 和 csv 等多种格式的文件进行转换。在获取 bytes 属性时，Unity 会从 native 层获取字节数组（byte[]），从而分配一定的堆内存。</p>
<p>另一个 API 指的是 WWW 这个类的 bytes 成员，每次对其进行调用都会导致堆内存的分配，需要指出的是 Unity 已经放弃了 WWW 这个类的相关接口，所以我们建议大家使用 UnityWebRequest 来实现相关的功能。</p>
<hr>
<p>以上我们就目前 <a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.uwa4d.com/archives/pipelinesummary.html">本地资源检测</a> 中提供的检测项均做了分析和解读，希望以上这些知识点能在实际的开发过程中为大家带来帮助，同时我们也会基于广大开发者的需求反馈，不断增加新的检测项。</p>
<p>需要说明的是，每一项检测规则的阈值都可以由开发团队依据自身项目的实际需求去设置合适的阈值范围，这也是本地资源检测的一大特点。同时，<a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.uwa4d.com/archives/pipelinesummary.html">也欢迎大家来使用 UWA 推出的本地资源检测服务，可帮助大家尽早对项目建立科学的美术规范。</a></p>
<p><img src="/images/loading.gif" data-lazy-src="https://img-blog.csdnimg.cn/img_convert/81c78636982dc6782941ac9e8bec0de3.png"></p>
<p>万行代码屹立不倒，全靠基础掌握得好！</p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.uwa4d.com/archives/UWA_Pipeline34.html">《场景检测：面片、光影和物理属性》</a><br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.uwa4d.com/archives/UWA_Pipeline33.html">《场景检测：Audio Listener、RigidBody 和 Prefab 连接》</a><br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.uwa4d.com/archives/UWA_Pipeline32.html">《场景检测：雾效、Canvas 和碰撞体》</a><br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.uwa4d.com/archives/UWA_Pipeline31.html">《特效优化 2：效果与性能的博弈》</a><br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.uwa4d.com/archives/UWA_Pipeline30.html">《特效优化：发现绚丽背后的质朴》</a><br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.uwa4d.com/archives/UWA_Pipeline29.html">《Prefab 优化：预制体中的各种细节选择》</a></p>
<p>** 性能黑榜相关阅读 **</p>
<p><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.uwa4d.com/archives/UWA_Pipeline12.html">《那些年给性能埋过的坑，你跳了吗？》</a><br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.uwa4d.com/archives/UWA_Pipeline13.html">《那些年给性能埋过的坑，你跳了吗？（第二弹）》</a><br><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.uwa4d.com/archives/UWA_Pipeline14.html">《掌握了这些规则，你已经战胜了 80% 的对手！》</a></p>
<hr>
<blockquote>
<p>参考链接： <a target="_blank" rel="noopener external nofollow noreferrer" href="https://mp.weixin.qq.com/s?__biz=MzI3MzA2MzE5Nw==&mid=2668921613&idx=1&sn=1bfe40c83bed539a99da3bd713da041c&chksm=f1c92f7fc6bea669b40c2f29d4502e51dd092b8b365647d484cefb2070f258f2b21bdc730fa3&mpshare=1&scene=1&srcid=0202X571uIUVTTHhDKgtuzWr&sharer_sharetime=1612274232517&sharer_shareid=910c857e658863471383ed705718aeb8&version=3.1.7.3005&platform=win#rd">[ C# 代码优化：斩断伸向堆内存的“黑手” ]</a></p>
</blockquote>
<hr>
<blockquote>
<p>to be continued…</p>
</blockquote>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://tamsiree.com">Tamsiree</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://tamsiree.com/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C/CSharp%E4%BB%A3%E7%A0%81%E4%BC%98%E5%8C%96%E5%A0%86%E5%86%85%E5%AD%98/">https://tamsiree.com/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C/CSharp%E4%BB%A3%E7%A0%81%E4%BC%98%E5%8C%96%E5%A0%86%E5%86%85%E5%AD%98/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://tamsiree.com" target="_blank">Tamsiree</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/">编程语言</a><a class="post-meta__tags" href="/tags/C/">C#</a></div><div class="post-share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/Tamsiree/Assets@master/Picture/Blog/Cover/1-1-1024x576.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>赞助</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/Tamsiree/Assets@master/Function/qrcode_wechat.jpg" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" src="/images/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/Tamsiree/Assets@master/Function/qrcode_wechat.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/Tamsiree/Assets@master/Function/qrcode_alipay.jpg" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" src="/images/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/Tamsiree/Assets@master/Function/qrcode_alipay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Lua/Lua%E6%8A%80%E5%B7%A7/" title="Lua 技巧"><img class="cover" src="/images/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/Tamsiree/Assets@master/Picture/Blog/Cover/yangguang-1024x576.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Lua 技巧</div></div><div class="info-2"><div class="info-item-1">前言在平常开发过程中，总会遇到一些需求点，做下记录。 正文lua 中 . 和 : 的区别   首先在 lua 中使用 “:” 定义的函数会自动传入一个名为 self 的变量，这个变量是隐含的，self 同 c++ 中的 this 一样，表示当前对象的指针：而 “.” 定义的函数中没有 self。  12345678910111213function  class:func2( )  endfunction  class.func1(self)  end  -- 这时候这两个函数等价  function MainScene:ctor()    self:ceshi(1,2,3)endfunction MainScene:ceshi(a,b,c)    print(a,b,c)end&gt; 输出: 1 2 3  table 排序1234567891011121314function asc()  -- 升序  table.sort(test_table) endfunction desc()  if args and #args &gt; 1 then    -- 做倒序处理   ...</div></div></div></a><a class="pagination-related" href="/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C/CSharp%E4%BB%A3%E7%A0%81%E4%BC%98%E5%8C%96CPU%E8%80%97%E6%97%B6/" title="C# 代码优化 CPU 耗时"><img class="cover" src="/images/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/Tamsiree/Assets@master/Picture/Blog/Cover/wp1904594-cpu-wallpapers.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">C# 代码优化 CPU 耗时</div></div><div class="info-2"><div class="info-item-1">前言之前，我们已经对 ** 本地资源检测 ** 中和资源 / Prefab 的内容做了总结（详情可扫描文末长图），后续 UWA 也会和大家一起努力，进一步丰富这些检测内容。今天我们要聚焦的是本地资源检测中的 C# 代码相关的检测项。 要保证游戏在流畅的帧率下运行，就要保证 CPU 和 GPU 能够及时地完成它们在一帧当中的“任务”。而本文我们讲解的这些 C# 代码的性能，就会影响到每帧 CPU 自身的耗时。当游戏出现帧率降低、间歇性卡顿甚至卡死等现象时，** 我们就需要考虑这是否是由开发者自己所编写的脚本性能较差所造成的。**  性能的优化问题，实际上是个 “时空问题”：我们要尽可能地节省运算所需的时间，节约内存上占用的空间。对 C# 代码的优化亦是如此，一方面是对 CPU 耗时的优化，一方面是对内存分配的优化。而“空间问题” 与“时间问题”又常常会相互转化——优化内存的目的之一，是减少 GC，这又可以归结为减少 CPU 耗时。本文要讲解的一系列规则，就是主要针对 CPU 耗时的规则。‍  1、类中存在 OnGUI 方法 规则里涉及到的 OnGUI，它是 Unity 的 IMGU...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C/CSharp%E6%96%B0%E7%89%B9%E6%80%A7/" title="C# 新特性"><img class="cover" src="/images/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/Tamsiree/Assets@master/Picture/Blog/Cover/bg-2bb1450.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2021-03-25</div><div class="info-item-2">C# 新特性</div></div><div class="info-2"><div class="info-item-1">前言在 C#8.0 中新增了两个新的特性，System.Index 及 System.Range，这是借助对应的两个运算符 ^ 及 ..，让我们很方便就可以获取序列中某个或一段元素。 正文System.IndexSystem.Index 表示索引类型，^ 指定的索引是相对于序列尾端。如 ^2 表示从序列尾端、从右至左的第二个元素。这里始终记住 ^x 等价于 list.length - x ，所以如果代码写成 list[^0]，那么等价于 list[list.length-0]，结果就会抛出异常。下边举例说明。 123456789101112131415161718var list = new[]&#123;    &quot; 爱 & quot;,&quot; 情 & quot;,&quot; 公 & quot;,&quot; 寓 & quot;,&quot; 曾 & quot;,&quot; 小 & quot;,&quot; 贤 & quot;,&quot; 胡 & quot;,&quot; 一 & quot;,&quot; 菲 & quot;,&quot; 吕 & quot;...</div></div></div></a><a class="pagination-related" href="/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C/CSharp%E4%BB%A3%E7%A0%81%E4%BC%98%E5%8C%96CPU%E8%80%97%E6%97%B6/" title="C# 代码优化 CPU 耗时"><img class="cover" src="/images/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/Tamsiree/Assets@master/Picture/Blog/Cover/wp1904594-cpu-wallpapers.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2021-05-11</div><div class="info-item-2">C# 代码优化 CPU 耗时</div></div><div class="info-2"><div class="info-item-1">前言之前，我们已经对 ** 本地资源检测 ** 中和资源 / Prefab 的内容做了总结（详情可扫描文末长图），后续 UWA 也会和大家一起努力，进一步丰富这些检测内容。今天我们要聚焦的是本地资源检测中的 C# 代码相关的检测项。 要保证游戏在流畅的帧率下运行，就要保证 CPU 和 GPU 能够及时地完成它们在一帧当中的“任务”。而本文我们讲解的这些 C# 代码的性能，就会影响到每帧 CPU 自身的耗时。当游戏出现帧率降低、间歇性卡顿甚至卡死等现象时，** 我们就需要考虑这是否是由开发者自己所编写的脚本性能较差所造成的。**  性能的优化问题，实际上是个 “时空问题”：我们要尽可能地节省运算所需的时间，节约内存上占用的空间。对 C# 代码的优化亦是如此，一方面是对 CPU 耗时的优化，一方面是对内存分配的优化。而“空间问题” 与“时间问题”又常常会相互转化——优化内存的目的之一，是减少 GC，这又可以归结为减少 CPU 耗时。本文要讲解的一系列规则，就是主要针对 CPU 耗时的规则。‍  1、类中存在 OnGUI 方法 规则里涉及到的 OnGUI，它是 Unity 的 IMGU...</div></div></div></a><a class="pagination-related" href="/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/C/CSharp%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/" title="C# 单例模式"><img class="cover" src="/images/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/Tamsiree/Assets@master/Picture/Blog/Cover/c770f4bef54f44ae8478539b01a47e4f.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2021-07-02</div><div class="info-item-2">C# 单例模式</div></div><div class="info-2"><div class="info-item-1">前言单例模式是软件工程学中最富盛名的设计模式之一。从本质上看，单例模式只允许被其自身实例化一次，且向外部提供了一个访问该实例的接口。通常来说，单例对象进行实例化时一般不带参数，因为如果不同的实例化请求传递的参数不同的话会导致问题的产生。(若多个请求都是传递的同样的参数的话，工厂模式更应该被考虑) C# 中实现单例有很多种方法，本文将按顺序介绍非线程安全、完全懒汉式、线程安全和低 / 高性能集中版本。 在所有的实现版本中，都有以下几个共同点：  唯一的、私有的且无参的构造函数，这样不允许外部类进行实例化； 类是密封的，尽管这不是强制的，但是严格来讲从上一点来看密封类能有助于 JIT 的优化； 一个静态变量应该指向类的唯一实例； 一个公共的静态变量用于获得这个类的唯一实例 (如果需要, 应该创建它）；  需要注意的是，本文中所有的例子中都是用一个 public static Instance 的变量来访问单例类实例，要将其转换成公共函数是很容易的，但是这样并不会带来效率和线程安全上的提升。 正文Version 1 - 非线程安全public sealed class Singleto...</div></div></div></a><a class="pagination-related" href="/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Goland/GoLand%E6%BF%80%E6%B4%BB%E7%A0%81/" title="GoLand 激活码"><img class="cover" src="/images/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/Tamsiree/Assets@master/Picture/Blog/Cover/1css34660a6917f03b1249f8a1923d36ef.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2020-03-17</div><div class="info-item-2">GoLand 激活码</div></div><div class="info-2"><div class="info-item-1">正文激活 GoLand 时，选择 License server 方式地址填入： 1http://fls.jetbrains-agent.com  点击：”Activate”。按照以下图片操作 - 操作完毕 - 重启 IDE，激活完成。    to be continued…  </div></div></div></a><a class="pagination-related" href="/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Android/RxTool/Wiki/RxTool-Wiki/" title="RxTool Wiki"><img class="cover" src="/images/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/Tamsiree/Assets@master/DeskTop/miku.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2016-10-14</div><div class="info-item-2">RxTool Wiki</div></div><div class="info-2"><div class="info-item-1">RxTool Wiki    工欲善其事必先利其器！   Android 开发过程经常需要用到各式各样的工具类，虽然大部分只需谷歌 / 百度一下就能找到；   但是有时候急需使用却苦苦搜寻不到，于是整理了自己平常用到的工具类，以便以后的使用。  自定义 View   Name description Module    RxAutoImageView ImageView 实现自动左右移动效果 RxUI   RxBarCode 条形码控件 RxUI   RxCaptcha 验证码控件 RxUI   RxCardStackView 银行卡组叠加效果 RxUI   RxCobwebView 蛛网等级控件 RxUI   RxHeartLayout 直播爱心点赞控件 RxUI   RxNetSpeedView 显示当前网速控件 RxUI   RxPopupView 自定义 PopupWindow 控件 RxUI   RxProgressBar 自定义进度条 RxUI   RxQRCode 二维码控件 RxUI   RxRoundProgress 实现弧形进度条 RxUI   RxRuler...</div></div></div></a><a class="pagination-related" href="/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Golang/Golang/" title="Golang"><img class="cover" src="/images/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/Tamsiree/Assets@master/Picture/Blog/Cover/bfhajlkdgahgf16617a.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2020-03-17</div><div class="info-item-2">Golang</div></div><div class="info-2"><div class="info-item-1">前言Go 语言是 Google 开发的一种静态强类型、编译型、并发型，并具有垃圾回收功能的编程语言，它用批判吸收的眼光，融合 C 语言、Java 等众家之长，将简洁、高效演绎得淋漓尽致。 Go 语言起源于 2007 年，当时 Google 的技术大神们备受 C++ 越来越臃肿的困扰，决心开发一种新的语言来取代 C++。他们认为：与其在臃肿的语言上不断增加新的特性，不如简化编程语言。于是，Golang 这门新语言应运而生。 在十年多的时间里，Go 语言发展势头强劲，凭借其简洁、高效的特性，在竞争激烈的编程语言市场中占据了一席之地。Google、腾讯、阿里等大公司纷纷选择使用 Go 语言来开发服务应用项目。当然，和其他的编程语言一样，Go 语言也有其自身的缺陷。 正文特点及优势Go 语言的设计者们一直致力于降低构建简单、可靠、高效软件的门槛。相比于其他语言，Go 语言具有众多令人兴奋不已的特点和优势： **1. 自动垃圾回收降低了开发难度 ** 内存和资源管理一直是一个让人非常抓狂的难题。在其他语言（如 C 或 C++）中，使用内存前要先分配这段内存，使用完毕后再将其释放掉，一个小疏...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/images/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/Tamsiree/Assets@master/Avatar/avatar_sky_circle.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Tamsiree</div><div class="author-info-description">勇于尝试才有可能迈向成功</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">200</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">140</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">143</div></a></div><a id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/tamsiree"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Tamsiree" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github-square"></i></a><a class="social-icon" href="mailto:tamsiree.com@gmail.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope-square"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss-square"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">只有用心灵才能看得清事物的本质，真正重要的东西是肉眼无法看见的。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E8%AF%A5%E7%B1%BB%E7%9A%84%E6%96%B9%E6%B3%95%E4%B8%AD%E5%AD%98%E5%9C%A8-tag-%E7%9A%84%E8%B0%83%E7%94%A8"><span class="toc-number">1.1.</span> <span class="toc-text">1、该类的方法中存在 .tag 的调用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E8%AF%A5%E7%B1%BB%E7%9A%84%E6%96%B9%E6%B3%95%E4%B8%AD%E5%AD%98%E5%9C%A8%E5%AF%B9%E7%BA%B9%E7%90%86-GetPixels-GetPixels32-%E8%B0%83%E7%94%A8"><span class="toc-number">1.2.</span> <span class="toc-text">2、该类的方法中存在对纹理 GetPixels()&#x2F;GetPixels32()调用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E8%AF%A5%E7%B1%BB%E7%9A%84%E6%96%B9%E6%B3%95%E4%B8%AD%E5%AD%98%E5%9C%A8-GetComponentsInChildren-%E8%B0%83%E7%94%A8-%E8%AF%A5%E7%B1%BB%E7%9A%84%E6%96%B9%E6%B3%95%E4%B8%AD%E5%AD%98%E5%9C%A8-GetComponentsInParent-%E8%B0%83%E7%94%A8"><span class="toc-number">1.3.</span> <span class="toc-text">3、该类的方法中存在 GetComponentsInChildren 调用 &#x2F; 该类的方法中存在 GetComponentsInParent 调用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E8%AF%A5%E7%B1%BB%E7%9A%84%E6%96%B9%E6%B3%95%E4%B8%AD%E5%AD%98%E5%9C%A8-Linq-%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0%E7%9A%84%E8%B0%83%E7%94%A8"><span class="toc-number">1.4.</span> <span class="toc-text">4、该类的方法中存在 Linq 相关函数的调用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81%E8%AF%A5%E7%B1%BB%E7%9A%84%E6%96%B9%E6%B3%95%E4%B8%AD%E5%AD%98%E5%9C%A8%E5%AF%B9-Renderer-%E8%BF%9B%E8%A1%8C-sharedMaterials-%E7%9A%84%E8%8E%B7%E5%8F%96"><span class="toc-number">1.5.</span> <span class="toc-text">5、该类的方法中存在对 Renderer 进行 sharedMaterials 的获取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%E3%80%81%E8%AF%A5%E7%B1%BB%E7%9A%84%E6%96%B9%E6%B3%95%E4%B8%AD%E5%AD%98%E5%9C%A8-Input-touches-%E8%B0%83%E7%94%A8"><span class="toc-number">1.6.</span> <span class="toc-text">6、该类的方法中存在 Input.touches 调用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7%E3%80%81FindObjectsOfType-%E8%B0%83%E7%94%A8"><span class="toc-number">1.7.</span> <span class="toc-text">7、FindObjectsOfType 调用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8%E3%80%81%E8%AF%A5%E7%B1%BB%E7%9A%84%E6%96%B9%E6%B3%95%E4%B8%AD%E5%AD%98%E5%9C%A8-TextAsset-WWW-bytes-%E8%B0%83%E7%94%A8"><span class="toc-number">1.8.</span> <span class="toc-text">8、该类的方法中存在 TextAsset&#x2F;WWW.bytes 调用</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/%E6%B8%B8%E6%88%8F/%E7%8B%AC%E7%AB%8B%E6%B8%B8%E6%88%8F/%E7%8B%AC%E7%AB%8B%E6%B8%B8%E6%88%8F%E7%9A%84%E6%88%90%E5%8A%9F%E4%B9%8B%E6%AF%8D/" title="独立游戏的成功之母"><img src="/images/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/Tamsiree/Assets@master/Picture/Blog/Cover/552b1999aa4d5a2e75352fa2f6e93d51.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="独立游戏的成功之母"/></a><div class="content"><a class="title" href="/%E6%B8%B8%E6%88%8F/%E7%8B%AC%E7%AB%8B%E6%B8%B8%E6%88%8F/%E7%8B%AC%E7%AB%8B%E6%B8%B8%E6%88%8F%E7%9A%84%E6%88%90%E5%8A%9F%E4%B9%8B%E6%AF%8D/" title="独立游戏的成功之母">独立游戏的成功之母</a><time datetime="2025-11-11T05:08:38.000Z" title="发表于 2025-11-11 13:08:38">2025-11-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Docker/MongoDB/Docker%E4%B8%ADMongoDB%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D/" title="Docker 中 MongoDB 数据库的备份与恢复"><img src="/images/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/Tamsiree/Assets@master/Picture/Blog/Cover/cdd893c83169033d6b4a8354f1ab9d37.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Docker 中 MongoDB 数据库的备份与恢复"/></a><div class="content"><a class="title" href="/Docker/MongoDB/Docker%E4%B8%ADMongoDB%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D/" title="Docker 中 MongoDB 数据库的备份与恢复">Docker 中 MongoDB 数据库的备份与恢复</a><time datetime="2025-11-06T00:49:58.000Z" title="发表于 2025-11-06 08:49:58">2025-11-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/%E9%9A%8F%E6%89%8B%E8%AE%B0/Unity%E5%A4%9A%E7%BA%BF%E7%A8%8B%E6%B8%B2%E6%9F%93%E5%AF%BC%E8%87%B4%E9%83%A8%E5%88%86%E6%89%8B%E6%9C%BA%E5%B4%A9%E6%BA%83/" title="Unity 多线程渲染导致部分手机崩溃"><img src="/images/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/Tamsiree/Assets@master/Picture/Blog/Cover/9408053447.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Unity 多线程渲染导致部分手机崩溃"/></a><div class="content"><a class="title" href="/%E9%9A%8F%E6%89%8B%E8%AE%B0/Unity%E5%A4%9A%E7%BA%BF%E7%A8%8B%E6%B8%B2%E6%9F%93%E5%AF%BC%E8%87%B4%E9%83%A8%E5%88%86%E6%89%8B%E6%9C%BA%E5%B4%A9%E6%BA%83/" title="Unity 多线程渲染导致部分手机崩溃">Unity 多线程渲染导致部分手机崩溃</a><time datetime="2023-11-09T11:55:51.000Z" title="发表于 2023-11-09 19:55:51">2023-11-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/%E9%9A%8F%E6%89%8B%E8%AE%B0/%E5%A5%BD%E7%94%A8%E7%9A%84CDN%E4%B9%8BjsDelivr/" title="好用的 CDN 之 jsDelivr"><img src="/images/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/Tamsiree/Assets@master/DeskTop/20b24a69649941669d83bb997b01fed6.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="好用的 CDN 之 jsDelivr"/></a><div class="content"><a class="title" href="/%E9%9A%8F%E6%89%8B%E8%AE%B0/%E5%A5%BD%E7%94%A8%E7%9A%84CDN%E4%B9%8BjsDelivr/" title="好用的 CDN 之 jsDelivr">好用的 CDN 之 jsDelivr</a><time datetime="2023-10-16T07:00:56.000Z" title="发表于 2023-10-16 15:00:56">2023-10-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/%E9%9A%8F%E6%89%8B%E8%AE%B0/Unity%E5%9D%90%E6%A0%87%E7%B3%BB%E7%BB%9F/" title="Unity 坐标系统"><img src="/images/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/Tamsiree/Assets@master/DeskTop/wallhaven-z8rqjo.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Unity 坐标系统"/></a><div class="content"><a class="title" href="/%E9%9A%8F%E6%89%8B%E8%AE%B0/Unity%E5%9D%90%E6%A0%87%E7%B3%BB%E7%BB%9F/" title="Unity 坐标系统">Unity 坐标系统</a><time datetime="2023-10-14T06:11:46.000Z" title="发表于 2023-10-14 14:11:46">2023-10-14</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2016 - 2025 By Tamsiree</span></div><div class="footer_custom_text">不要盯着我看，已经到底啦～</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.3"></script><script src="/js/main.js?v=5.5.3"></script><script src="/js/tw_cn.js?v=5.5.3"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@6.1.7/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@19.1.3/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(() => {
  let initFn = window.walineFn || null
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = {"placeholder":"留下你的脚印与心声~","pageSize":10,"lang":"zh-CN","requiredFields":["nick"],"avatar":"wavatar"}

  const destroyWaline = ele => ele.destroy()

  const initWaline = (Fn, el = document, path = window.location.pathname) => {
    const waline = Fn({
      el: el.querySelector('#waline-wrap'),
      serverURL: 'https://comment.tamsiree.com',
      pageview: false,
      dark: 'html[data-theme="dark"]',
      comment: false,
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    if (isShuoshuo) {
      window.shuoshuoComment.destroyWaline = () => {
        destroyWaline(waline)
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }
  }

  const loadWaline = (el, path) => {
    if (initFn) initWaline(initFn, el, path)
    else {
      btf.getCSS('https://cdn.jsdelivr.net/npm/@waline/client@3.8.0/dist/waline.min.css')
        .then(() => import('https://cdn.jsdelivr.net/npm/@waline/client@3.8.0/dist/waline.min.js'))
        .then(({ init }) => {
          initFn = init || Waline.init
          initWaline(initFn, el, path)
          window.walineFn = initFn
        })
    }
  }

  if (isShuoshuo) {
    'Waline' === 'Waline'
      ? window.shuoshuoComment = { loadComment: loadWaline } 
      : window.loadOtherComment = loadWaline
    return
  }

  if ('Waline' === 'Waline' || !true) {
    if (true) btf.loadComment(document.getElementById('waline-wrap'),loadWaline)
    else setTimeout(loadWaline, 0)
  } else {
    window.loadOtherComment = loadWaline
  }
})()</script></div><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8688374801147098" crossorigin="anonymous"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/canvas-fluttering-ribbon.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/metingjs/dist/Meting.min.js"></script><script>(() => {
  const destroyAplayer = () => {
    if (window.aplayers) {
      for (let i = 0; i < window.aplayers.length; i++) {
        if (!window.aplayers[i].options.fixed) {
          window.aplayers[i].destroy()
        }
      }
    }
  }

  const runMetingJS = () => {
    typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()
  }

  btf.addGlobalFn('pjaxSend', destroyAplayer, 'destroyAplayer')
  btf.addGlobalFn('pjaxComplete', loadMeting, 'runMetingJS')
})()</script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js" defer="defer"></script><script>document.addEventListener('DOMContentLoaded', () => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"]):not([href="/talking/"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => {
      try {
        fn()
      } catch (err) {
        console.debug('Pjax callback failed:', err)
      }
    })
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      true
        ? pjax.loadUrl('/404.html')
        : window.location.href = e.request.responseURL
    }
  })
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="local-search-input"><input placeholder="搜索文章" type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.3"></script></div></div></body></html>